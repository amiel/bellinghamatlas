<%# map_javascripts @map %>

<%
  js_var :submissions, @submissions.each_with_object({}){|s,h|
    h[s.id] = {
      :name => s.name,
      :info_window_path => info_window_submission_path(s),
      :lat => s.lat,
      :lng => s.lng,
      :media_type => s.media_type,
      :media_color => s.media_color,
    }
  }
%>

<div id="the_story" class="<%= 'js-hide' if @goldi_has_spoken %>">
  <div>So, goldi is cool and stuff, and she said cool stuff. That is all!
  <%= content_tag :span, 'close', :class => 'close' %>
  </div>
</div>

<%= @map.div %>

<div id="right">
	<ul id="submissions">
	  <% if @featured_submission %>
  	  <li id="featured_submission">
  	    <%= media_for @featured_submission, :thumb %><br />
  	    <h4><%= @featured_submission.title %></h4>
        <div class="person" style="background-image: url(<%= @featured_submission.gravatar_url(:size => 16) %>)"><%= @featured_submission.name %></div>
  	  </li>
  	<% end %>
		<% for submission in @submissions %>
      <% content_tag_for :li, submission do %>
	      <%= submission.title %> <span><%= submission.name %></span>
      <% end %>
		<% end %>
	</ul>
	<div class="buttons">
	  <%= link_to t(:lucky), '#', :class => "button" %>
	  <%= link_to "Add Yours", new_submission_path, :class => "button" %>
	</div>
</div>


